#joystick <- joystick[order(joystick$Treatment), ]
#joystick$rank <- (joystick$Treatment!="66")*1
new_order <- order(joystick$mean, decreasing = T)
joystick <- joystick[new_order,]
joystick$rank <- grepl("TrpA1", joystick$line)*1
new_order <- order(joystick$rank, decreasing = T)
joystick <- joystick[new_order,]
barCenters <- barplot(height = joystick$mean,
names.arg = as.character(joystick$line),
beside = true, las = 2,ylim=c(-1,1),
cex.names = 0.75,
main = "Screen Joystick effectsize with yellow light",
ylab = "Reinforcement (PI training - PI pretest)",
border = "black", axes = TRUE)
segments(barCenters, joystick$mean - joystick$se, barCenters,
joystick$mean + joystick$se, lwd = 1.5)
library("psych", lib.loc="~/R/win-library/3.4")
#idGroup$ymazes <- line_names$scores[1:23]
plot(idGroup$ymazes ~ idGroup$mean)
idGroup$mean <- NULL
mean <- NULL
scores_in_c <- matrix(NaN,8,23)
for (i in 1:23) {
scores_in_col <-Tmaze$PI[idGroup$Group[i]==Tmaze$Fly.line]
scores_in_c[1:length(scores_in_col),i] <-scores_in_col
}
colors <- c("green","red","green","orange","orange","red","red","red","orange","black","black","black","black","black","black","black","black")
#driver_group <- c("Positive classical","Negative classical","Positive classical","Neutral classical","Neutral classical","Negative classical","Negative classical","Neutral classical","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep")
errorCircles(1:17,1:17,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="T-maze scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.6,0.65),xlim=c(-0.20,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
rect(0, 0, 3, 4, col= rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
rect(0, 0, -3, -4, col = rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
library("psych", lib.loc="~/R/win-library/3.4")
#idGroup$ymazes <- line_names$scores[1:23]
plot(idGroup$ymazes ~ idGroup$mean)
idGroup$mean <- NULL
mean <- NULL
scores_in_c <- matrix(NaN,8,23)
for (i in 1:23) {
scores_in_col <-Tmaze$PI[idGroup$Group[i]==Tmaze$Fly.line]
scores_in_c[1:length(scores_in_col),i] <-scores_in_col
}
colors <- c("green","red","green","orange","orange","red","red","red","orange","black","black","black","black","black","black","black","black")
#driver_group <- c("Positive classical","Negative classical","Positive classical","Neutral classical","Neutral classical","Negative classical","Negative classical","Neutral classical","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep")
errorCircles(1:17,1:17,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="T-maze scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.6,0.65),xlim=c(-0.20,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
rect(0, 0, 3, 4, col= rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
rect(0, 0, -3, -4, col = rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
dev.off()
dev.off()
library("psych", lib.loc="~/R/win-library/3.4")
#idGroup$ymazes <- line_names$scores[1:23]
plot(idGroup$ymazes ~ idGroup$mean)
idGroup$mean <- NULL
mean <- NULL
scores_in_c <- matrix(NaN,8,23)
for (i in 1:23) {
scores_in_col <-Tmaze$PI[idGroup$Group[i]==Tmaze$Fly.line]
scores_in_c[1:length(scores_in_col),i] <-scores_in_col
}
colors <- c("green","red","green","orange","orange","red","red","red","orange","black","black","black","black","black","black","black","black")
#driver_group <- c("Positive classical","Negative classical","Positive classical","Neutral classical","Neutral classical","Negative classical","Negative classical","Neutral classical","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep")
errorCircles(1:17,1:17,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="T-maze scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.6,0.65),xlim=c(-0.20,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
rect(0, 0, 3, 4, col= rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
rect(0, 0, -3, -4, col = rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
ymazes_biplot_joystick <- effect_occupancy_clean[,c(15,23,34,14,9,13,12,3,31,16)]
joystick_biplot_ymazes <- SCREEn_effectsize[1:25,-9]
scores2<-rbind(ymazes_biplot_joystick,joystick_biplot_ymazes)
scores2$experiment <- c(rep(1,120),rep(2,25))
errorCircles(1:10,1:10,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="Joystick scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.7,0.6),xlim=c(-0.12,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
rect(0, 0, 3, 4, col= rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
rect(0, 0, -3, -4, col = rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
dev.off()
View(scores2)
errorCircles(1:11,1:11,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="Joystick scores",
xlab="T-maze with yellow light",main="Joystick vs T-maze",ylim=c(-0.5,0.6),xlim=c(-0.4,0.4))
abline(a=0,b=0,v=2,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
library(psych)
errorCircles(1:11,1:11,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="Joystick scores",
xlab="T-maze with yellow light",main="Joystick vs T-maze",ylim=c(-0.5,0.6),xlim=c(-0.4,0.4))
abline(a=0,b=0,v=2,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
errorCircles(1:11,1:11,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="Joystick scores",
xlab="T-maze with yellow light",main="Joystick vs T-maze",ylim=c(-0.5,0.6),xlim=c(-0.4,0.4))
abline(a=0,b=0,v=2,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
errorCircles(1:11,1:11,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="Tmaze with yellow light",
xlab="Tmaze with red light",main="Y-mazes vs T-maze",ylim=c(-1,1),xlim=c(-0.6,0.7))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=2,lwd=3 )
load("C:/Users/chise/Desktop/phd_screens/screen_biplots_and_models.RData")
View(joystick)
colnames(SCREEn_effectsize)
View(SCREEn_effectsize)
barCenters <- barplot(height = joystick$mean,
names.arg = as.character(joystick$line),
beside = true, las = 2,ylim=c(-1,1),
cex.names = 0.75,
main = "Screen Joystick effectsize with yellow light",
ylab = "Reinforcement (PI training - PI pretest)",
border = "black", axes = TRUE)
joystick<- colnames(SCREEn_effectsize)
joystick<-data.frame(joystick)
joystick$mean <- apply(SCREEn_effectsize,2, function(x) mean(x,na.rm=TRUE))
joystick$sd <- apply(SCREEn_effectsize,2, function(x) sd(x,na.rm=TRUE))
joystick$n <- apply(SCREEn_effectsize,2, function(x) length(x[!is.na(x)]))
joystick$se <- joystick$sd/sqrt(joystick$n)
joystick$line <- joystick$joystick
joystick$line <- gsub("orange1", "TH", joystick$line)
joystick$line <- gsub("orange2", "mb304b", joystick$line)
joystick$line <- gsub("orange3", "mb109b", joystick$line)
joystick$line <- gsub("orange4", "58E02", joystick$line)
joystick$line <- gsub("blue1", "TH-D'", joystick$line)
joystick$line <- gsub("blue2", "TH-D1", joystick$line)
joystick$line <- gsub("blue3", "TH-D4", joystick$line)
joystick$line <- gsub("blue4", "TH-F3", joystick$line)
joystick$line <- gsub("lightyellow1", "Gr28bd+TrpA1", joystick$line)
joystick$line <- gsub("lightyellow2", "NP5272", joystick$line)
joystick$line <- gsub("lightyellow3", "MZ840", joystick$line)
joystick$line <- gsub("lightyellow4", "TH-C'", joystick$line)
joystick$line <- gsub("darkgreen1", "mb315c", joystick$line)
joystick$line <- gsub("darkgreen2", "TH-D1", joystick$line)
joystick$line <- gsub("darkgreen3", "mb299b", joystick$line)
joystick$line <- gsub("red1", "5htr1b", joystick$line)
joystick$line <- gsub("red2", "TH-G80+TH-G4", joystick$line)
joystick$line <- gsub("red3", "mb025b", joystick$line)
joystick$line <- gsub("red4", "mb060b", joystick$line)
joystick$line <- gsub("lightgreen1", "mb056b", joystick$line)
joystick$line <- gsub("lightgreen2", "mb312b", joystick$line)
joystick$line <- gsub("lightgreen3", "mb032b", joystick$line)
joystick$line <- gsub("lightgreen4", "mb065b", joystick$line)
joystick$line <- gsub("darkyellow1", "th", joystick$line)
joystick$line <- gsub("darkyellow2", "NP1528", joystick$line)
joystick$line <- gsub("darkyellow3", "TH-C1+TH-F1", joystick$line)
joystick$line <- gsub("darkyellow4", "DDC(HL9)", joystick$line)
joystick$line <- gsub("pink1", "MZ19", joystick$line)
joystick$line <- gsub("pink2", "TH-F1", joystick$line)
joystick$line <- gsub("pink3", "TH-F2", joystick$line)
joystick$line <- gsub("pink4", "DDC(HL8)", joystick$line)
joystick$line <- gsub("white1", "TH-G1", joystick$line)
joystick$line <- gsub("white2", "NP6510", joystick$line)
joystick$line <- gsub("positivecontrol1", "Gr28bd+TrpA1", joystick$line)
new_order <- order(joystick$mean, decreasing = T)
joystick <- joystick[new_order,]
#joystick$Treatment <- c(rep("Experimental",11),"positive control")
#joystick <- joystick[order(joystick$Treatment), ]
#joystick$rank <- (joystick$Treatment!="66")*1
new_order <- order(joystick$mean, decreasing = T)
joystick <- joystick[new_order,]
joystick$rank <- grepl("TrpA1", joystick$line)*1
new_order <- order(joystick$rank, decreasing = T)
joystick <- joystick[new_order,]
barCenters <- barplot(height = joystick$mean,
names.arg = as.character(joystick$line),
beside = true, las = 2,ylim=c(-1,1),
cex.names = 0.75,
main = "Screen Joystick effectsize with yellow light",
ylab = "Reinforcement (PI training - PI pretest)",
border = "black", axes = TRUE)
plot(idGroup$ymazes ~ idGroup$mean)
colors <- c("green","red","green","orange","orange","red","red","red","orange","black","black","black","black","black","black","black","black")
#driver_group <- c("Positive classical","Negative classical","Positive classical","Neutral classical","Neutral classical","Negative classical","Negative classical","Neutral classical","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep")
errorCircles(1:17,1:17,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="T-maze scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.6,0.65),xlim=c(-0.20,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
rect(0, 0, 3, 4, col= rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
rect(0, 0, -3, -4, col = rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
colors <- c("green","red","green","orange","orange","red","red","red","orange","black","black","black","black","black","black","black","black")
#driver_group <- c("Positive classical","Negative classical","Positive classical","Neutral classical","Neutral classical","Negative classical","Negative classical","Neutral classical","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep")
errorCircles(1:17,1:17,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="T-maze scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.6,0.65),xlim=c(-0.20,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
rect(0, 0, 3, 4, col= rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
rect(0, 0, -3, -4, col = rgb(0,0,1.0,alpha=0.1), border = "transparent") # coloured
library("psych", lib.loc="~/R/win-library/3.4")
colors <- c("green","red","green","orange","orange","red","red","red","orange","black","black","black","black","black","black","black","black")
#driver_group <- c("Positive classical","Negative classical","Positive classical","Neutral classical","Neutral classical","Negative classical","Negative classical","Neutral classical","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep","Arousal-sleep")
errorCircles(1:17,1:17,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="T-maze scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.6,0.65),xlim=c(-0.20,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
detach("package:psych", unload = TRUE)
library(psych)
errorCircles(1:17,1:17,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="T-maze scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.6,0.65),xlim=c(-0.20,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
errorCircles(1:10,1:10,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="Joystick scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.7,0.6),xlim=c(-0.12,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
errorCircles(1:10,1:10,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="Joystick scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.7,0.6),xlim=c(-0.12,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
View(scores2)
View(scores_in_c_yellow)
View(Tmaze_yellow)
View(Tmaze)
scores_in_c_yellow <- matrix(NaN,12,28)
for (i in 1:28) {
scores_in_col <-Tmaze$PI[idGroup$Group[i]==Tmaze$Fly.line]
scores_in_c_yellow[1:length(scores_in_col),i] <-scores_in_col
}
idGroup$line[c(18,17,16,21,26,15,14,9,24,5,12)]
yellow_tmaze<-scores_in_c_yellow[,c(18,17,16,21,26,15,14,9,24,5,12)]
yellow_joystick<-SCREEn_effectsize[1:25,-12]
colnames(yellow_tmaze)<-idGroup$line[c(18,17,16,21,26,15,14,9,24,5,12)]
colnames(yellow_joystick)<-idGroup$line[c(18,17,16,21,26,15,14,9,24,5,12)]
scores2<-rbind(yellow_tmaze,yellow_joystick)
scores2<-as.data.frame(scores2)
scores2$experiment <- c(rep(1,12),rep(2,25))
colors <- c("red","black","red","black","black","black","black","green","black","red","black")
postscript("Joystick_Tmaze_yellow_biplot.eps")
errorCircles(1:11,1:11,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="Joystick scores",
xlab="T-maze with yellow light",main="Joystick vs T-maze",ylim=c(-0.5,0.6),xlim=c(-0.4,0.4))
abline(a=0,b=0,v=2,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
barCenters <- barplot(height = line_names_clean$scores,
names.arg = as.character(line_names_clean$V1),
beside = true, las = 2,ylim=c(-1,1),
cex.names = 0.75,
main = "Occupancy screen Y-mazes",
ylab = "Occupancy rate",
border = "black", axes = TRUE)
plot(idGroup$ymazes ~ idGroup$mean)
View(idGroup)
View(SCREEn_effectsize)
write.table(SCREEn_effectsize,"joystick_screen.txt")
dev.off()
dev.off()
dev.off()
View(idGroup)
View(idGroup_yellow)
write.table(idGroup,"Tmaze_red_screen.txt")
write.table(idGroup_yellow,"Tmaze_yellow_screen.txt")
View(effect_occupancy_compact)
View(effect_occupancy_clean)
write.table(effect_occupancy_clean,"Ymazes_screen.txt")
effect_occupancy_clean <- read.table("Ymazes_screen.txt", header = TRUE)
View(effect_occupancy_clean)
joystick_screen <- read.table("joystick_screen.txt", header = TRUE)
joystick_screen <- read.table("joystick_screen.txt", header = TRUE)
idGroup_yellow <- read.table("Tmaze_yellow_screen.txt", header = TRUE)
idGroup <- read.table("Tmaze_red_screen.txt", header = TRUE)
View(idGroup)
View(idGroup_yellow)
View(effect_occupancy_clean)
View(joystick_screen)
joystick<- colnames(joystick_screen)
joystick<-data.frame(joystick)
joystick$mean <- apply(joystick_screen,2, function(x) mean(x,na.rm=TRUE))
joystick$sd <- apply(joystick_screen,2, function(x) sd(x,na.rm=TRUE))
joystick$n <- apply(joystick_screen,2, function(x) length(x[!is.na(x)]))
joystick$se <- joystick$sd/sqrt(joystick$n)
joystick$line <- joystick$joystick
joystick$line <- gsub("orange1", "TH", joystick$line)
joystick$line <- gsub("orange2", "mb304b", joystick$line)
joystick$line <- gsub("orange3", "mb109b", joystick$line)
joystick$line <- gsub("orange4", "58E02", joystick$line)
joystick$line <- gsub("blue1", "TH-D'", joystick$line)
joystick$line <- gsub("blue2", "TH-D1", joystick$line)
joystick$line <- gsub("blue3", "TH-D4", joystick$line)
joystick$line <- gsub("blue4", "TH-F3", joystick$line)
joystick$line <- gsub("lightyellow1", "Gr28bd+TrpA1", joystick$line)
joystick$line <- gsub("lightyellow2", "NP5272", joystick$line)
joystick$line <- gsub("lightyellow3", "MZ840", joystick$line)
joystick$line <- gsub("lightyellow4", "TH-C'", joystick$line)
joystick$line <- gsub("darkgreen1", "mb315c", joystick$line)
joystick$line <- gsub("darkgreen2", "TH-D1", joystick$line)
joystick$line <- gsub("darkgreen3", "mb299b", joystick$line)
joystick$line <- gsub("red1", "5htr1b", joystick$line)
joystick$line <- gsub("red2", "TH-G80+TH-G4", joystick$line)
joystick$line <- gsub("red3", "mb025b", joystick$line)
joystick$line <- gsub("red4", "mb060b", joystick$line)
joystick$line <- gsub("lightgreen1", "mb056b", joystick$line)
joystick$line <- gsub("lightgreen2", "mb312b", joystick$line)
joystick$line <- gsub("lightgreen3", "mb032b", joystick$line)
joystick$line <- gsub("lightgreen4", "mb065b", joystick$line)
joystick$line <- gsub("darkyellow1", "th", joystick$line)
joystick$line <- gsub("darkyellow2", "NP1528", joystick$line)
joystick$line <- gsub("darkyellow3", "TH-C1+TH-F1", joystick$line)
joystick$line <- gsub("darkyellow4", "DDC(HL9)", joystick$line)
joystick$line <- gsub("pink1", "MZ19", joystick$line)
joystick$line <- gsub("pink2", "TH-F1", joystick$line)
joystick$line <- gsub("pink3", "TH-F2", joystick$line)
joystick$line <- gsub("pink4", "DDC(HL8)", joystick$line)
joystick$line <- gsub("white1", "TH-G1", joystick$line)
joystick$line <- gsub("white2", "NP6510", joystick$line)
joystick$line <- gsub("positivecontrol1", "Gr28bd+TrpA1", joystick$line)
new_order <- order(joystick$mean, decreasing = T)
joystick <- joystick[new_order,]
#joystick$Treatment <- c(rep("Experimental",11),"positive control")
#joystick <- joystick[order(joystick$Treatment), ]
#joystick$rank <- (joystick$Treatment!="66")*1
new_order <- order(joystick$mean, decreasing = T)
joystick <- joystick[new_order,]
joystick$rank <- grepl("TrpA1", joystick$line)*1
new_order <- order(joystick$rank, decreasing = T)
joystick <- joystick[new_order,]
View(joystick)
idGroup$mean <- NULL
mean <- NULL
scores_in_c <- matrix(NaN,8,23)
for (i in 1:23) {
scores_in_col <-Tmaze$PI[idGroup$Group[i]==Tmaze$Fly.line]
scores_in_c[1:length(scores_in_col),i] <-scores_in_col
}
load("C:/Users/chise/Desktop/phd_screens/screen_biplots_and_models.RData")
write.table(Tmaze,"Tmaze_read_screen.txt")
write.table(Tmaze_yellow,"Tmaze_yellow_screen2.txt")
effect_occupancy_clean <- read.table("Ymazes_screen.txt", header = TRUE)
idGroup_yellow <- read.table("Tmaze_yellow_screen_aggregated.txt", header = TRUE)
idGroup <- read.table("Tmaze_red_screen_aggregated.txt", header = TRUE)
joystick_screen <- read.table("joystick_screen.txt", header = TRUE)
Tmaze <- read.table("Tmaze_red_screen_aggregated.txt", header = TRUE)
Tmaze_yellow <- read.table("Tmaze_yellow_screen.txt", header = TRUE)
View(Tmaze)
View(Tmaze_yellow)
joystick<- colnames(joystick_screen)
joystick<-data.frame(joystick)
joystick$mean <- apply(joystick_screen,2, function(x) mean(x,na.rm=TRUE))
joystick$sd <- apply(joystick_screen,2, function(x) sd(x,na.rm=TRUE))
joystick$n <- apply(joystick_screen,2, function(x) length(x[!is.na(x)]))
joystick$se <- joystick$sd/sqrt(joystick$n)
joystick$line <- joystick$joystick
joystick$line <- gsub("orange1", "TH", joystick$line)
joystick$line <- gsub("orange2", "mb304b", joystick$line)
joystick$line <- gsub("orange3", "mb109b", joystick$line)
joystick$line <- gsub("orange4", "58E02", joystick$line)
joystick$line <- gsub("blue1", "TH-D'", joystick$line)
joystick$line <- gsub("blue2", "TH-D1", joystick$line)
joystick$line <- gsub("blue3", "TH-D4", joystick$line)
joystick$line <- gsub("blue4", "TH-F3", joystick$line)
joystick$line <- gsub("lightyellow1", "Gr28bd+TrpA1", joystick$line)
joystick$line <- gsub("lightyellow2", "NP5272", joystick$line)
joystick$line <- gsub("lightyellow3", "MZ840", joystick$line)
joystick$line <- gsub("lightyellow4", "TH-C'", joystick$line)
joystick$line <- gsub("darkgreen1", "mb315c", joystick$line)
joystick$line <- gsub("darkgreen2", "TH-D1", joystick$line)
joystick$line <- gsub("darkgreen3", "mb299b", joystick$line)
joystick$line <- gsub("red1", "5htr1b", joystick$line)
joystick$line <- gsub("red2", "TH-G80+TH-G4", joystick$line)
joystick$line <- gsub("red3", "mb025b", joystick$line)
joystick$line <- gsub("red4", "mb060b", joystick$line)
joystick$line <- gsub("lightgreen1", "mb056b", joystick$line)
joystick$line <- gsub("lightgreen2", "mb312b", joystick$line)
joystick$line <- gsub("lightgreen3", "mb032b", joystick$line)
joystick$line <- gsub("lightgreen4", "mb065b", joystick$line)
joystick$line <- gsub("darkyellow1", "th", joystick$line)
joystick$line <- gsub("darkyellow2", "NP1528", joystick$line)
joystick$line <- gsub("darkyellow3", "TH-C1+TH-F1", joystick$line)
joystick$line <- gsub("darkyellow4", "DDC(HL9)", joystick$line)
joystick$line <- gsub("pink1", "MZ19", joystick$line)
joystick$line <- gsub("pink2", "TH-F1", joystick$line)
joystick$line <- gsub("pink3", "TH-F2", joystick$line)
joystick$line <- gsub("pink4", "DDC(HL8)", joystick$line)
joystick$line <- gsub("white1", "TH-G1", joystick$line)
joystick$line <- gsub("white2", "NP6510", joystick$line)
joystick$line <- gsub("positivecontrol1", "Gr28bd+TrpA1", joystick$line)
new_order <- order(joystick$mean, decreasing = T)
joystick <- joystick[new_order,]
#joystick$Treatment <- c(rep("Experimental",11),"positive control")
#joystick <- joystick[order(joystick$Treatment), ]
#joystick$rank <- (joystick$Treatment!="66")*1
new_order <- order(joystick$mean, decreasing = T)
joystick <- joystick[new_order,]
joystick$rank <- grepl("TrpA1", joystick$line)*1
new_order <- order(joystick$rank, decreasing = T)
joystick <- joystick[new_order,]
library("psych", lib.loc="~/R/win-library/3.4")
idGroup$mean <- NULL
mean <- NULL
scores_in_c <- matrix(NaN,8,23)
for (i in 1:23) {
scores_in_col <-Tmaze$PI[idGroup$Group[i]==Tmaze$Fly.line]
scores_in_c[1:length(scores_in_col),i] <-scores_in_col
}
View(scores_in_c)
scores_in_col
for (i in 1:23) {
scores_in_col <-Tmaze$PI[idGroup$Group[i]==Tmaze$Fly.line]
#scores_in_c[1:length(scores_in_col),i] <-scores_in_col
}
View(Tmaze)
for (i in 1:23) {
scores_in_col <-Tmaze$mean[idGroup$Group[i]==Tmaze$Group]
#scores_in_c[1:length(scores_in_col),i] <-scores_in_col
}
scores_in_c <- matrix(NaN,8,23)
for (i in 1:23) {
scores_in_col <-Tmaze$mean[idGroup$Group[i]==Tmaze$Group]
scores_in_c[1:length(scores_in_col),i] <-scores_in_col
}
View(scores_in_c)
colors <- c("green","red","green","orange","orange","red","red","red","orange","black","black","black","black","black","black","black","black")
errorCircles(1:17,1:17,data=scores2,group="experiment",paired=TRUE,pch=16,cex=2,colors=colors,circles=FALSE,ylab="T-maze scores",
xlab="Y-mazes scores",main="Y-mazes vs T-maze",ylim=c(-0.6,0.65),xlim=c(-0.20,0.27))
abline(a=0,b=0,v=1,h=0,lwd =3 )
abline(a=0,b=0,v=0,h=1,lwd=3 )
scores
ymazes_biplot_joystick <- effect_occupancy_clean[,c(15,23,34,14,9,13,12,3,31,16)]
joystick_biplot_ymazes <- joystick_screen[1:25,-9]
scores2<-rbind(ymazes_biplot_joystick,joystick_biplot_ymazes)
scores2$experiment <- c(rep(1,120),rep(2,25))
ymazes_biplot_joystick <- effect_occupancy_clean[,c(15,23,34,14,9,13,12,3,31,16)]
joystick_biplot_ymazes <- joystick_screen[1:25,-9]
View(joystick_biplot_ymazes)
joystick_screen[1:25,-9]
joystick_screen[1:24,-9]
joystick_screen[1:25,-10]
joystick_screen[1:25,-8]
ymazes_biplot_joystick <- effect_occupancy_clean[,c(15,23,34,14,9,13,12,3,31,16)]
joystick_biplot_ymazes <- joystick_screen[1:25,-8]
scores2<-rbind(ymazes_biplot_joystick,joystick_biplot_ymazes)
scores2$experiment <- c(rep(1,120),rep(2,25))
colors <- c("red","black","red","black","black","black","black","green","black","black")
length(joystick_screen[1:25,-8])
length(joystick_screen[1:25,-9])
length(joystick_screen[1:25,-10])
View(joystick_screen)
joystick[-12]
joystick_screen[-12]
length(joystick_screen[-12])
length(joystick_screen[-12,-11])
length(joystick_screen[c(-12,-11)])
joystick_screen[1:25,c(-9,-12)]
ymazes_biplot_joystick <- effect_occupancy_clean[,c(15,23,34,14,9,13,12,3,31,16)]
joystick_biplot_ymazes <- joystick_screen[1:25,c(-9,-12)]
scores2<-rbind(ymazes_biplot_joystick,joystick_biplot_ymazes)
scores2$experiment <- c(rep(1,120),rep(2,25))
View(joystick_screen)
colnames(joystick_screen)
colnames(joystick_screen) <- gsub("orange1", "TH", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("orange2", "mb304b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("orange3", "mb109b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("orange4", "58E02", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("blue1", "TH-D'", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("blue2", "TH-D1", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("blue3", "TH-D4", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("blue4", "TH-F3", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("lightyellow1", "Gr28bd+TrpA1", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("lightyellow2", "NP5272", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("lightyellow3", "MZ840", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("lightyellow4", "TH-C'", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("darkgreen1", "mb315c", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("darkgreen2", "TH-D1", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("darkgreen3", "mb299b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("red1", "5htr1b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("red2", "TH-G80+TH-G4", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("red3", "mb025b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("red4", "mb060b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("lightgreen1", "mb056b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("lightgreen2", "mb312b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("lightgreen3", "mb032b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("lightgreen4", "mb065b", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("darkyellow1", "th", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("darkyellow2", "NP1528", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("darkyellow3", "TH-C1+TH-F1", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("darkyellow4", "DDC(HL9)", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("pink1", "MZ19", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("pink2", "TH-F1", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("pink3", "TH-F2", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("pink4", "DDC(HL8)", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("white1", "TH-G1", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("white2", "NP6510", colnames(joystick_screen))
colnames(joystick_screen) <- gsub("positivecontrol1", "Gr28bd+TrpA1", colnames(joystick_screen))
colnames(joystick_screen)
joystick<- colnames(joystick_screen)
joystick<-data.frame(joystick)
joystick$mean <- apply(joystick_screen,2, function(x) mean(x,na.rm=TRUE))
joystick$sd <- apply(joystick_screen,2, function(x) sd(x,na.rm=TRUE))
joystick$n <- apply(joystick_screen,2, function(x) length(x[!is.na(x)]))
joystick$se <- joystick$sd/sqrt(joystick$n)
joystick
new_order <- order(joystick$mean, decreasing = T)
joystick <- joystick[new_order,]
#joystick$Treatment <- c(rep("Experimental",11),"positive control")
#joystick <- joystick[order(joystick$Treatment), ]
#joystick$rank <- (joystick$Treatment!="66")*1
new_order <- order(joystick$mean, decreasing = T)
joystick <- joystick[new_order,]
joystick$rank <- grepl("TrpA1", joystick$line)*1
new_order <- order(joystick$rank, decreasing = T)
joystick <- joystick[new_order,]
View(joystick)
joystick$rank <- grepl("TrpA1", joystick$joystick)*1
new_order <- order(joystick$rank, decreasing = T)
joystick <- joystick[new_order,]
View(joystick)
colnames(joystick)[1]
colnames(joystick)[1] <- "line"
colnames(joystick)[1]
ymazes_biplot_joystick <- effect_occupancy_clean[,c(15,23,34,14,9,13,12,3,31,16)]
joystick_biplot_ymazes <- joystick_screen[1:25,c(-9,-12)]
scores2<-rbind(ymazes_biplot_joystick,joystick_biplot_ymazes)
joystick_biplot_ymazes
colnames(joystick_biplot_ymazes)
colnames(ymazes_biplot_joystick)
